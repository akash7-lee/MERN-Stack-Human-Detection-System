{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\leeak\\\\human-detection-mern\\\\frontend\\\\src\\\\components\\\\DetectionCanvas.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DetectionCanvas = ({\n  model,\n  detectionMode,\n  setStats\n}) => {\n  _s();\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const imageRef = useRef(null);\n  const [stream, setStream] = useState(null);\n  const animationRef = useRef(null);\n  useEffect(() => {\n    if (detectionMode === 'webcam') {\n      startWebcam();\n    } else if (detectionMode === 'stopped') {\n      stopDetection();\n    }\n    return () => stopDetection();\n  }, [detectionMode]);\n  const startWebcam = async () => {\n    try {\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          width: 1280,\n          height: 720\n        }\n      });\n      videoRef.current.srcObject = mediaStream;\n      setStream(mediaStream);\n      videoRef.current.onloadedmetadata = () => {\n        const canvas = canvasRef.current;\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n        detectFrame();\n      };\n    } catch (error) {\n      console.error('Camera error:', error);\n      alert('Camera access denied');\n    }\n  };\n  const stopDetection = () => {\n    if (animationRef.current) {\n      cancelAnimationFrame(animationRef.current);\n    }\n    if (stream) {\n      stream.getTracks().forEach(track => track.stop());\n      setStream(null);\n    }\n    if (videoRef.current) {\n      videoRef.current.srcObject = null;\n    }\n  };\n  const detectFrame = async () => {\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    if (!video || !canvas || !model) return;\n    const startTime = performance.now();\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    const predictions = await model.detect(canvas);\n    const people = predictions.filter(p => p.class === 'person');\n    drawPredictions(ctx, people);\n    const fps = Math.round(1000 / (performance.now() - startTime));\n    const avgConfidence = people.length > 0 ? people.reduce((sum, p) => sum + p.score, 0) / people.length : 0;\n    setStats({\n      peopleCount: people.length,\n      confidence: Math.round(avgConfidence * 100),\n      fps\n    });\n    animationRef.current = requestAnimationFrame(detectFrame);\n  };\n  const drawPredictions = (ctx, predictions) => {\n    predictions.forEach(prediction => {\n      const [x, y, width, height] = prediction.bbox;\n      ctx.strokeStyle = '#00ff00';\n      ctx.lineWidth = 3;\n      ctx.strokeRect(x, y, width, height);\n      const label = `Person ${Math.round(prediction.score * 100)}%`;\n      ctx.font = 'bold 18px Arial';\n      const textWidth = ctx.measureText(label).width;\n      ctx.fillStyle = '#00ff00';\n      ctx.fillRect(x, y - 30, textWidth + 10, 30);\n      ctx.fillStyle = '#000000';\n      ctx.fillText(label, x + 5, y - 8);\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"canvas-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      playsInline: true,\n      style: {\n        display: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      ref: imageRef,\n      alt: \"\",\n      style: {\n        display: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 5\n  }, this);\n};\n_s(DetectionCanvas, \"/0peeXaZxs7lf3tXinOUN/OCdDU=\");\n_c = DetectionCanvas;\nexport default DetectionCanvas;\nvar _c;\n$RefreshReg$(_c, \"DetectionCanvas\");","map":{"version":3,"names":["React","useRef","useEffect","useState","jsxDEV","_jsxDEV","DetectionCanvas","model","detectionMode","setStats","_s","videoRef","canvasRef","imageRef","stream","setStream","animationRef","startWebcam","stopDetection","mediaStream","navigator","mediaDevices","getUserMedia","video","width","height","current","srcObject","onloadedmetadata","canvas","videoWidth","videoHeight","detectFrame","error","console","alert","cancelAnimationFrame","getTracks","forEach","track","stop","ctx","getContext","startTime","performance","now","drawImage","predictions","detect","people","filter","p","class","drawPredictions","fps","Math","round","avgConfidence","length","reduce","sum","score","peopleCount","confidence","requestAnimationFrame","prediction","x","y","bbox","strokeStyle","lineWidth","strokeRect","label","font","textWidth","measureText","fillStyle","fillRect","fillText","className","children","ref","autoPlay","playsInline","style","display","fileName","_jsxFileName","lineNumber","columnNumber","alt","_c","$RefreshReg$"],"sources":["C:/Users/leeak/human-detection-mern/frontend/src/components/DetectionCanvas.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\n\nconst DetectionCanvas = ({ model, detectionMode, setStats }) => {\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const imageRef = useRef(null);\n  const [stream, setStream] = useState(null);\n  const animationRef = useRef(null);\n\n  useEffect(() => {\n    if (detectionMode === 'webcam') {\n      startWebcam();\n    } else if (detectionMode === 'stopped') {\n      stopDetection();\n    }\n    return () => stopDetection();\n  }, [detectionMode]);\n\n  const startWebcam = async () => {\n    try {\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\n        video: { width: 1280, height: 720 }\n      });\n      videoRef.current.srcObject = mediaStream;\n      setStream(mediaStream);\n      videoRef.current.onloadedmetadata = () => {\n        const canvas = canvasRef.current;\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n        detectFrame();\n      };\n    } catch (error) {\n      console.error('Camera error:', error);\n      alert('Camera access denied');\n    }\n  };\n\n  const stopDetection = () => {\n    if (animationRef.current) {\n      cancelAnimationFrame(animationRef.current);\n    }\n    if (stream) {\n      stream.getTracks().forEach(track => track.stop());\n      setStream(null);\n    }\n    if (videoRef.current) {\n      videoRef.current.srcObject = null;\n    }\n  };\n\n  const detectFrame = async () => {\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n\n    if (!video || !canvas || !model) return;\n\n    const startTime = performance.now();\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n    const predictions = await model.detect(canvas);\n    const people = predictions.filter(p => p.class === 'person');\n\n    drawPredictions(ctx, people);\n    \n    const fps = Math.round(1000 / (performance.now() - startTime));\n    const avgConfidence = people.length > 0\n      ? people.reduce((sum, p) => sum + p.score, 0) / people.length\n      : 0;\n\n    setStats({\n      peopleCount: people.length,\n      confidence: Math.round(avgConfidence * 100),\n      fps\n    });\n\n    animationRef.current = requestAnimationFrame(detectFrame);\n  };\n\n  const drawPredictions = (ctx, predictions) => {\n    predictions.forEach(prediction => {\n      const [x, y, width, height] = prediction.bbox;\n      \n      ctx.strokeStyle = '#00ff00';\n      ctx.lineWidth = 3;\n      ctx.strokeRect(x, y, width, height);\n      \n      const label = `Person ${Math.round(prediction.score * 100)}%`;\n      ctx.font = 'bold 18px Arial';\n      const textWidth = ctx.measureText(label).width;\n      \n      ctx.fillStyle = '#00ff00';\n      ctx.fillRect(x, y - 30, textWidth + 10, 30);\n      \n      ctx.fillStyle = '#000000';\n      ctx.fillText(label, x + 5, y - 8);\n    });\n  };\n\n  return (\n    <div className=\"canvas-container\">\n      <video\n        ref={videoRef}\n        autoPlay\n        playsInline\n        style={{ display: 'none' }}\n      />\n      <img ref={imageRef} alt=\"\" style={{ display: 'none' }} />\n      <canvas ref={canvasRef} />\n    </div>\n  );\n};\n\nexport default DetectionCanvas;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}